(function(i,c){"use strict";const s="wusong8899-client1-header-adv",d=["Kick","Facebook","Twitter","YouTube","Instagram"];class g extends c{oninit(e){super.oninit(e),this.setting(`${s}.settings`)()||this.migrateFromLegacy(),this.getSettings().slides.length===0&&this.addDefaultSlides()}getSettings(){try{const e=this.setting(`${s}.settings`)()||"{}",t=JSON.parse(e);return{slides:t.slides||[],transitionTime:t.transitionTime||5e3,socialLinks:t.socialLinks||[],headerIcon:t.headerIcon||{url:i.data.settings[`${s}.headerIconUrl`]||"",link:i.data.settings[`${s}.headerIconLink`]||""}}}catch(e){return console.error("Failed to parse settings JSON:",e),{slides:[],transitionTime:5e3,socialLinks:[],headerIcon:{url:i.data.settings[`${s}.headerIconUrl`]||"",link:i.data.settings[`${s}.headerIconLink`]||""}}}}updateSettings(e){try{const t=JSON.stringify(e);this.setting(`${s}.settings`)(t),this.setting(`${s}.TransitionTime`)(e.transitionTime.toString()),e.headerIcon&&(this.setting(`${s}.headerIconUrl`)(e.headerIcon.url||""),this.setting(`${s}.headerIconLink`)(e.headerIcon.link||""))}catch(t){console.error("Failed to save settings:",t)}}migrateFromLegacy(){const e={slides:[],transitionTime:parseInt(i.data.settings[`${s}.TransitionTime`])||5e3,socialLinks:[],headerIcon:{url:i.data.settings[`${s}.headerIconUrl`]||"",link:i.data.settings[`${s}.headerIconLink`]||""}};for(let t=1;t<=30;t++){const n=i.data.settings[`${s}.Image${t}`],a=i.data.settings[`${s}.Link${t}`];(n||a)&&e.slides.push({id:`legacy-${t}`,image:n||"",link:a||"",active:!0,order:t})}d.forEach(t=>{const n=i.data.settings[`${s}.Social${t}Url`],a=i.data.settings[`${s}.Social${t}Icon`];(n||a)&&e.socialLinks.push({platform:t,url:n||"",icon:a||""})}),this.updateSettings(e)}addDefaultSlides(){const e=this.getSettings();e.slides=[{id:"slide-default-1",image:"https://via.placeholder.com/800x400/FF6B6B/FFFFFF?text=Advertisement+1",link:"https://example.com/ad1",active:!0,order:1},{id:"slide-default-2",image:"https://via.placeholder.com/800x400/4ECDC4/FFFFFF?text=Advertisement+2",link:"https://example.com/ad2",active:!0,order:2}],this.updateSettings(e)}addSlide(){const e=this.getSettings(),t={id:`slide-${Date.now()}`,image:"",link:"",active:!0,order:e.slides.length+1};e.slides.push(t),this.updateSettings(e)}deleteSlide(e){const t=this.getSettings();t.slides=t.slides.filter(n=>n.id!==e),t.slides.forEach((n,a)=>{n.order=a+1}),this.updateSettings(t)}updateSlide(e,t,n){const a=this.getSettings(),l=a.slides.find(r=>r.id===e);l&&(l[t]=n,this.updateSettings(a))}updateSocialLink(e,t,n){const a=this.getSettings();let l=a.socialLinks.find(r=>r.platform===e);l||(l={platform:e,url:"",icon:""},a.socialLinks.push(l)),l[t]=n,this.updateSettings(a)}updateHeaderIcon(e,t){const n=this.getSettings();n.headerIcon||(n.headerIcon={url:"",link:""}),n.headerIcon[e]=t,this.updateSettings(n)}content(){const e=this.getSettings();return m("div",{className:"ExtensionPage-settings"},m("div",{className:"container"},m("div",{className:"UnifiedAdminComponent"},m("div",{className:"Form-group"},m("h3",null,i.translator.trans("wusong8899-client1.admin.GlobalSettings")),m("label",{className:"FormLabel"},i.translator.trans("wusong8899-client1.admin.TransitionTime")),m("input",{className:"FormControl",type:"number",min:"1000",max:"30000",value:e.transitionTime,oninput:t=>{const n=this.getSettings();n.transitionTime=parseInt(t.target.value),this.updateSettings(n)}})),m("div",{className:"Form-group"},m("h3",null,i.translator.trans("wusong8899-client1.admin.HeaderIconTitle")),m("label",{className:"FormLabel"},i.translator.trans("wusong8899-client1.admin.HeaderIconUrl")),m("input",{className:"FormControl",type:"url",value:e.headerIcon?.url||"",placeholder:i.translator.trans("wusong8899-client1.admin.HeaderIconUrlHelp"),oninput:t=>{this.updateHeaderIcon("url",t.target.value)}}),m("label",{className:"FormLabel"},i.translator.trans("wusong8899-client1.admin.HeaderIconLink")),m("input",{className:"FormControl",type:"url",value:e.headerIcon?.link||"",placeholder:i.translator.trans("wusong8899-client1.admin.HeaderIconLinkHelp"),oninput:t=>{this.updateHeaderIcon("link",t.target.value)}})),m("div",{className:"Form-group"},m("h3",null,i.translator.trans("wusong8899-client1.admin.SlidesManagement")),e.slides.map(t=>this.renderSlide(t)),m("button",{className:"Button Button--primary",onclick:()=>this.addSlide()},i.translator.trans("wusong8899-client1.admin.AddSlide"))),m("div",{className:"Form-group"},m("h3",null,i.translator.trans("wusong8899-client1.admin.SocialMediaTitle")),d.map(t=>this.renderSocialPlatform(t))),m("div",{className:"Form-group"},this.submitButton()))))}renderSlide(e){return m("div",{className:"SlideConfig",key:e.id},m("div",{className:"SlideConfig-header"},m("h4",null,"Slide ",e.order),m("input",{type:"checkbox",checked:e.active,onchange:t=>{this.updateSlide(e.id,"active",t.target.checked)}}),m("button",{className:"Button Button--danger",onclick:()=>this.deleteSlide(e.id)},i.translator.trans("wusong8899-client1.admin.DeleteButton"))),m("div",{className:"Form-group"},m("label",{className:"FormLabel"},i.translator.trans("wusong8899-client1.admin.SlideImageLabel")),m("input",{className:"FormControl",type:"url",value:e.image,oninput:t=>{this.updateSlide(e.id,"image",t.target.value)}})),m("div",{className:"Form-group"},m("label",{className:"FormLabel"},i.translator.trans("wusong8899-client1.admin.SlideLinkLabel")),m("input",{className:"FormControl",type:"url",value:e.link,oninput:t=>{this.updateSlide(e.id,"link",t.target.value)}})))}renderSocialPlatform(e){const n=this.getSettings().socialLinks.find(a=>a.platform===e)||{url:"",icon:""};return m("div",{className:"SocialPlatformConfig",key:e},m("h4",null,e),m("div",{className:"Form-group"},m("label",{className:"FormLabel"},"URL"),m("input",{className:"FormControl",type:"url",placeholder:`https://${e.toLowerCase()}.com/yourprofile`,value:n.url,oninput:a=>{this.updateSocialLink(e,"url",a.target.value)}})),m("div",{className:"Form-group"},m("label",{className:"FormLabel"},"Icon URL"),m("input",{className:"FormControl",type:"url",placeholder:"https://example.com/icon.png",value:n.icon,oninput:a=>{this.updateSocialLink(e,"icon",a.target.value)}}),n.icon&&m("div",{className:"IconPreview"},m("img",{src:n.icon,alt:`${e} icon`,style:"max-width: 32px; max-height: 32px;"}))))}}i.initializers.add(s,()=>{const o=i.extensionData.for(s);o.registerSetting({setting:`${s}.settings`,type:"text",label:"",hidden:!0}),o.registerSetting({setting:`${s}.TransitionTime`,type:"number",label:"",hidden:!0}),o.registerPage(g)})})(flarum.core.compat["admin/app"],flarum.core.compat["admin/components/ExtensionPage"]);
//# sourceMappingURL=admin.js.map

module.exports={};