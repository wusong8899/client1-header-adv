(function(e,u,o){"use strict";class S extends u{constructor(){super(...arguments),this.slides=[],this.loading=!1,this.nextId=1}oninit(t){super.oninit(t),this.loadExistingSlides()}loadExistingSlides(){const{extensionId:t,maxSlides:s=30}=this.attrs,i=[];for(let n=1;n<=s;n++){const r=`${t}.Link${n}`,l=`${t}.Image${n}`,a=e.data.settings[r]||"",c=e.data.settings[l]||"";(a||c)&&(i.push({id:n,link:a,image:c}),this.nextId=Math.max(this.nextId,n+1))}this.slides=i,i.length===0&&this.addSlide()}addSlide(){const t={id:this.nextId++,link:"",image:""};this.slides.push(t),m.redraw()}removeSlide(t){const{extensionId:s}=this.attrs,i=this.slides.findIndex(r=>r.id===t);if(i===-1)return;const n=this.slides[i];this.saveSetting(`${s}.Link${n.id}`,""),this.saveSetting(`${s}.Image${n.id}`,""),this.slides.splice(i,1),this.slides.length===0&&this.addSlide(),m.redraw()}updateSlide(t,s,i){const{extensionId:n}=this.attrs,r=this.slides.find(a=>a.id===t);if(!r)return;r[s]=i;const l=s==="link"?`${n}.Link${r.id}`:`${n}.Image${r.id}`;this.saveSetting(l,i)}saveSetting(t,s){const i=`saveTimeout_${t}`;clearTimeout(this[i]),this[i]=setTimeout(()=>{e.data.settings[t]=s,e.request({method:"POST",url:e.forum.attribute("apiUrl")+"/settings",body:{[t]:s}}).catch(()=>{})},500)}view(){return m("div.Form-group",[m("label.FormLabel",e.translator.trans("wusong8899-client1.admin.SlideSettings")),m("div.helpText",e.translator.trans("wusong8899-client1.admin.SlideSettingsHelp")),m("div.DynamicSlideSettings",[this.slides.map((t,s)=>this.renderSlide(t,s)),m("div.DynamicSlideSettings-addButton",[m(o,{className:"Button Button--primary",icon:"fas fa-plus",onclick:()=>this.addSlide()},e.translator.trans("wusong8899-client1.admin.AddSlide"))])])])}renderSlide(t,s){return m("div.DynamicSlideSettings-slide",{key:t.id},[m("div.DynamicSlideSettings-slideHeader",[m("h4",e.translator.trans("wusong8899-client1.admin.SlideNumber",{number:s+1})),m(o,{className:"Button Button--danger",icon:"fas fa-trash",onclick:()=>this.removeSlide(t.id),disabled:this.slides.length===1},e.translator.trans("wusong8899-client1.admin.DeleteSlide"))]),m("div.DynamicSlideSettings-slideFields",[m("div.Form-group",[m("label.FormLabel",e.translator.trans("wusong8899-client1.admin.SlideLink")),m("input.FormControl",{type:"url",placeholder:"https://example.com",value:t.link,oninput:i=>{const n=i.target;this.updateSlide(t.id,"link",n.value)}})]),m("div.Form-group",[m("label.FormLabel",e.translator.trans("wusong8899-client1.admin.SlideImage")),m("input.FormControl",{type:"url",placeholder:"https://example.com/image.jpg",value:t.image,oninput:i=>{const n=i.target;this.updateSlide(t.id,"image",n.value)}})])])])}}class h{constructor(t){this.extensionId=t,this.extensionData=e.extensionData.for(t)}registerTransitionTimeSetting(){return this.extensionData.registerSetting({setting:`${this.extensionId}.TransitionTime`,type:"number",label:e.translator.trans("wusong8899-client1.admin.TransitionTime")}),this}registerHeaderIconUrlSetting(){return this.extensionData.registerSetting({setting:`${this.extensionId}.HeaderIconUrl`,type:"url",label:e.translator.trans("wusong8899-client1.admin.HeaderIconUrl"),help:e.translator.trans("wusong8899-client1.admin.HeaderIconUrlHelp")}),this}registerSlideSettings(t=30){return this.extensionData.registerSetting(()=>m(S,{extensionId:this.extensionId,maxSlides:t})),this}registerAllSettings(t=30){return this.registerTransitionTimeSetting().registerHeaderIconUrlSetting().registerSlideSettings(t)}}const g={EXTENSION_ID:"wusong8899-client1-header-adv",MAX_SLIDES:30};function I(d=g.EXTENSION_ID,t=g.MAX_SLIDES){new h(d).registerAllSettings(t)}e.initializers.add("wusong8899/client1-header-adv",()=>{I()})})(flarum.core.compat["admin/app"],flarum.core.compat["common/Component"],flarum.core.compat["common/components/Button"]);
//# sourceMappingURL=admin.js.map

module.exports={};