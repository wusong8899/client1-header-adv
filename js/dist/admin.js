(function(e,S,c,s){"use strict";class h extends S{constructor(){super(...arguments),this.slides=[],this.loading=!1,this.nextId=1}oninit(t){super.oninit(t),this.loadExistingSlides()}loadExistingSlides(){const{extensionId:t,maxSlides:a=30}=this.attrs,i=[];for(let n=1;n<=a;n++){const r=`${t}.Link${n}`,o=`${t}.Image${n}`,d=e.data.settings[r]||"",u=e.data.settings[o]||"";(d||u)&&(i.push({id:n,link:d,image:u}),this.nextId=Math.max(this.nextId,n+1))}this.slides=i,i.length===0&&this.addSlide()}addSlide(){const t={id:this.nextId++,link:"",image:""};this.slides.push(t),s.redraw()}removeSlide(t){const{extensionId:a}=this.attrs,i=this.slides.findIndex(r=>r.id===t);if(i===-1)return;const n=this.slides[i];this.saveSetting(`${a}.Link${n.id}`,""),this.saveSetting(`${a}.Image${n.id}`,""),this.slides.splice(i,1),this.slides.length===0&&this.addSlide(),s.redraw()}updateSlide(t,a,i){const{extensionId:n}=this.attrs,r=this.slides.find(d=>d.id===t);if(!r)return;r[a]=i;const o=a==="link"?`${n}.Link${r.id}`:`${n}.Image${r.id}`;this.saveSetting(o,i)}saveSetting(t,a){const i=`saveTimeout_${t}`;clearTimeout(this[i]),this[i]=setTimeout(()=>{e.data.settings[t]=a,e.request({method:"POST",url:e.forum.attribute("apiUrl")+"/settings",body:{[t]:a}}).catch(()=>{})},500)}view(){return s("div.Form-group",[s("label.FormLabel",e.translator.trans("wusong8899-client1.admin.SlideSettings")),s("div.helpText",e.translator.trans("wusong8899-client1.admin.SlideSettingsHelp")),s("div.DynamicSlideSettings",[this.slides.map((t,a)=>this.renderSlide(t,a)),s("div.DynamicSlideSettings-addButton",[s(c,{className:"Button Button--primary",icon:"fas fa-plus",onclick:()=>this.addSlide()},e.translator.trans("wusong8899-client1.admin.AddSlide"))])])])}renderSlide(t,a){return s("div.DynamicSlideSettings-slide",{key:t.id},[s("div.DynamicSlideSettings-slideHeader",[s("h4",e.translator.trans("wusong8899-client1.admin.SlideNumber",{number:a+1})),s(c,{className:"Button Button--danger",icon:"fas fa-trash",onclick:()=>this.removeSlide(t.id),disabled:this.slides.length===1},e.translator.trans("wusong8899-client1.admin.DeleteSlide"))]),s("div.DynamicSlideSettings-slideFields",[s("div.Form-group",[s("label.FormLabel",e.translator.trans("wusong8899-client1.admin.SlideLink")),s("input.FormControl",{type:"url",placeholder:"https://example.com",value:t.link,oninput:i=>{const n=i.target;this.updateSlide(t.id,"link",n.value)}})]),s("div.Form-group",[s("label.FormLabel",e.translator.trans("wusong8899-client1.admin.SlideImage")),s("input.FormControl",{type:"url",placeholder:"https://example.com/image.jpg",value:t.image,oninput:i=>{const n=i.target;this.updateSlide(t.id,"image",n.value)}})])])])}}const g={app:{extensionId:"wusong8899-client1-header-adv"},slider:{maxSlides:30}},x=["Kick","Facebook","Twitter","YouTube","Instagram"];function I(l){const t=e.data.settings[`${l}.MaxSlides`];return t?parseInt(t):g.slider.maxSlides}e.initializers.add("wusong8899-client1-header-adv",()=>{const l=g.app.extensionId,t=e.extensionData.for(l);t.registerSetting({setting:`${l}.TransitionTime`,type:"number",label:e.translator.trans("wusong8899-client1.admin.TransitionTime")}),t.registerSetting({setting:`${l}.HeaderIconUrl`,type:"url",label:e.translator.trans("wusong8899-client1.admin.HeaderIconUrl"),help:e.translator.trans("wusong8899-client1.admin.HeaderIconUrlHelp")}),t.registerSetting({setting:`${l}.MaxSlides`,type:"number",label:e.translator.trans("wusong8899-client1.admin.MaxSlides"),help:e.translator.trans("wusong8899-client1.admin.MaxSlidesHelp")}),x.forEach(i=>{const n=`Social${i}Url`,r=`Social${i}Icon`;t.registerSetting({setting:`${l}.${n}`,type:"url",label:e.translator.trans(`wusong8899-client1.admin.${n}`),help:e.translator.trans(`wusong8899-client1.admin.${n}Help`)}),t.registerSetting({setting:`${l}.${r}`,type:"url",label:e.translator.trans(`wusong8899-client1.admin.${r}`),help:e.translator.trans("wusong8899-client1.admin.SocialIconHelp")})});const a=I(l);t.registerSetting(()=>m(h,{extensionId:l,maxSlides:a}))})})(flarum.core.compat["admin/app"],flarum.core.compat["common/Component"],flarum.core.compat["common/components/Button"],m);
//# sourceMappingURL=admin.js.map

module.exports={};