(function(e,u,c){"use strict";class h extends u{constructor(){super(...arguments),this.slides=[],this.loading=!1,this.nextId=1}oninit(t){super.oninit(t),this.loadExistingSlides()}loadExistingSlides(){const{extensionId:t,maxSlides:i=30}=this.attrs,n=[];for(let s=1;s<=i;s++){const a=`${t}.Link${s}`,d=`${t}.Image${s}`,l=e.data.settings[a]||"",S=e.data.settings[d]||"";(l||S)&&(n.push({id:s,link:l,image:S}),this.nextId=Math.max(this.nextId,s+1))}this.slides=n,n.length===0&&this.addSlide()}addSlide(){const t={id:this.nextId++,link:"",image:""};this.slides.push(t),m.redraw()}removeSlide(t){const{extensionId:i}=this.attrs,n=this.slides.findIndex(a=>a.id===t);if(n===-1)return;const s=this.slides[n];this.saveSetting(`${i}.Link${s.id}`,""),this.saveSetting(`${i}.Image${s.id}`,""),this.slides.splice(n,1),this.slides.length===0&&this.addSlide(),m.redraw()}updateSlide(t,i,n){const{extensionId:s}=this.attrs,a=this.slides.find(l=>l.id===t);if(!a)return;a[i]=n;const d=i==="link"?`${s}.Link${a.id}`:`${s}.Image${a.id}`;this.saveSetting(d,n)}saveSetting(t,i){const n=`saveTimeout_${t}`;clearTimeout(this[n]),this[n]=setTimeout(()=>{e.data.settings[t]=i,e.request({method:"POST",url:e.forum.attribute("apiUrl")+"/settings",body:{[t]:i}}).catch(()=>{})},500)}view(){return m("div.Form-group",[m("label.FormLabel",e.translator.trans("wusong8899-client1.admin.SlideSettings")),m("div.helpText",e.translator.trans("wusong8899-client1.admin.SlideSettingsHelp")),m("div.DynamicSlideSettings",[this.slides.map((t,i)=>this.renderSlide(t,i)),m("div.DynamicSlideSettings-addButton",[m(c,{className:"Button Button--primary",icon:"fas fa-plus",onclick:()=>this.addSlide()},e.translator.trans("wusong8899-client1.admin.AddSlide"))])])])}renderSlide(t,i){return m("div.DynamicSlideSettings-slide",{key:t.id},[m("div.DynamicSlideSettings-slideHeader",[m("h4",e.translator.trans("wusong8899-client1.admin.SlideNumber",{number:i+1})),m(c,{className:"Button Button--danger",icon:"fas fa-trash",onclick:()=>this.removeSlide(t.id),disabled:this.slides.length===1},e.translator.trans("wusong8899-client1.admin.DeleteSlide"))]),m("div.DynamicSlideSettings-slideFields",[m("div.Form-group",[m("label.FormLabel",e.translator.trans("wusong8899-client1.admin.SlideLink")),m("input.FormControl",{type:"url",placeholder:"https://example.com",value:t.link,oninput:n=>{const s=n.target;this.updateSlide(t.id,"link",s.value)}})]),m("div.Form-group",[m("label.FormLabel",e.translator.trans("wusong8899-client1.admin.SlideImage")),m("input.FormControl",{type:"url",placeholder:"https://example.com/image.jpg",value:t.image,oninput:n=>{const s=n.target;this.updateSlide(t.id,"image",s.value)}})])])])}}const o={slider:{maxSlides:30}};class x{constructor(t){this.extensionId=t,this.extensionData=e.extensionData.for(t)}registerTransitionTimeSetting(){return this.extensionData.registerSetting({setting:`${this.extensionId}.TransitionTime`,type:"number",label:e.translator.trans("wusong8899-client1.admin.TransitionTime")}),this}registerHeaderIconUrlSetting(){return this.extensionData.registerSetting({setting:`${this.extensionId}.HeaderIconUrl`,type:"url",label:e.translator.trans("wusong8899-client1.admin.HeaderIconUrl"),help:e.translator.trans("wusong8899-client1.admin.HeaderIconUrlHelp")}),this}registerMaxSlidesSetting(){return this.extensionData.registerSetting({setting:`${this.extensionId}.MaxSlides`,type:"number",label:e.translator.trans("wusong8899-client1.admin.MaxSlides"),help:e.translator.trans("wusong8899-client1.admin.MaxSlidesHelp")}),this}registerSocialMediaSettings(){return[{name:"Kick",urlKey:"SocialKickUrl",iconKey:"SocialKickIcon"},{name:"Facebook",urlKey:"SocialFacebookUrl",iconKey:"SocialFacebookIcon"},{name:"Twitter",urlKey:"SocialTwitterUrl",iconKey:"SocialTwitterIcon"},{name:"YouTube",urlKey:"SocialYouTubeUrl",iconKey:"SocialYouTubeIcon"},{name:"Instagram",urlKey:"SocialInstagramUrl",iconKey:"SocialInstagramIcon"}].forEach(i=>{this.extensionData.registerSetting({setting:`${this.extensionId}.${i.urlKey}`,type:"url",label:e.translator.trans(`wusong8899-client1.admin.${i.urlKey}`),help:e.translator.trans(`wusong8899-client1.admin.${i.urlKey}Help`)}),this.extensionData.registerSetting({setting:`${this.extensionId}.${i.iconKey}`,type:"url",label:e.translator.trans(`wusong8899-client1.admin.${i.iconKey}`),help:e.translator.trans("wusong8899-client1.admin.SocialIconHelp")})}),this}registerSlideSettings(t=o.slider.maxSlides){return this.extensionData.registerSetting(()=>m(h,{extensionId:this.extensionId,maxSlides:t})),this}registerAllSettings(t=o.slider.maxSlides){return this.registerTransitionTimeSetting().registerHeaderIconUrlSetting().registerMaxSlidesSetting().registerSocialMediaSettings().registerSlideSettings(t)}}const g={EXTENSION_ID:"wusong8899-client1-header-adv",MAX_SLIDES:o.slider.maxSlides};function I(r=g.EXTENSION_ID,t){const i=e.data.settings[`${r}.MaxSlides`],n=i?parseInt(i):g.MAX_SLIDES;new x(r).registerAllSettings(n)}e.initializers.add("wusong8899-client1-header-adv",()=>{I()})})(flarum.core.compat["admin/app"],flarum.core.compat["common/Component"],flarum.core.compat["common/components/Button"]);
//# sourceMappingURL=admin.js.map

module.exports={};