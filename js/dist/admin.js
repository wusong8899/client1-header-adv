(function(s,d){"use strict";const n="wusong8899-client1-header-adv",r=["Kick","Facebook","Twitter","YouTube","Instagram"];class c extends d{constructor(){super(...arguments),this.settings={slides:[],transitionTime:5e3,socialLinks:[]}}oninit(){this.loadSettings(),this.settings.slides.length===0&&this.addDefaultSlides()}addDefaultSlides(){console.log("Adding default test slides..."),this.settings.slides=[{id:"slide-default-1",image:"https://via.placeholder.com/800x400/FF6B6B/FFFFFF?text=Advertisement+1",link:"https://example.com/ad1",active:!0,order:1},{id:"slide-default-2",image:"https://via.placeholder.com/800x400/4ECDC4/FFFFFF?text=Advertisement+2",link:"https://example.com/ad2",active:!0,order:2}],this.saveSettings(),console.log("Default slides added:",this.settings.slides)}loadSettings(){try{console.log("Admin: Loading settings...");const t=s.data.settings[`${n}.settings`];console.log("Admin: JSON settings found:",t?"yes":"no"),t?(this.settings=JSON.parse(t),console.log("Admin: Loaded JSON settings:",this.settings)):(console.log("Admin: Falling back to legacy settings"),this.loadLegacySettings())}catch(t){console.error("Failed to load settings:",t),console.log("Admin: Falling back to legacy settings due to error"),this.loadLegacySettings()}}loadLegacySettings(){const t=[],i=[];for(let e=1;e<=30;e++){const a=s.data.settings[`${n}.Link${e}`]||"",l=s.data.settings[`${n}.Image${e}`]||"";(a||l)&&t.push({id:`slide-${e}`,image:l,link:a,active:!0,order:e})}r.forEach(e=>{const a=s.data.settings[`${n}.Social${e}Url`]||"",l=s.data.settings[`${n}.Social${e}Icon`]||"";i.push({platform:e,url:a,icon:l})}),this.settings={slides:t,transitionTime:parseInt(s.data.settings[`${n}.TransitionTime`])||5e3,socialLinks:i}}saveSettings(){const t=JSON.stringify(this.settings);console.log("Admin: Saving settings:",t),s.data.settings[`${n}.settings`]=t,s.data.settings[`${n}.TransitionTime`]=this.settings.transitionTime.toString(),console.log("Admin: Settings updated in app.data.settings"),m.redraw()}addSlide(){const t={id:`slide-${Date.now()}`,image:"",link:"",active:!0,order:this.settings.slides.length+1};this.settings.slides.push(t),this.saveSettings()}deleteSlide(t){this.settings.slides=this.settings.slides.filter(i=>i.id!==t),this.settings.slides.forEach((i,e)=>{i.order=e+1}),this.saveSettings()}updateSlide(t,i,e){const a=this.settings.slides.find(l=>l.id===t);a&&(a[i]=e,this.saveSettings())}updateSocialLink(t,i,e){let a=this.settings.socialLinks.find(l=>l.platform===t);a||(a={platform:t,url:"",icon:""},this.settings.socialLinks.push(a)),a[i]=e,this.saveSettings()}view(){return m("div",{className:"UnifiedAdminComponent"},m("div",{className:"Form-group"},m("h3",null,s.translator.trans("wusong8899-client1.admin.GlobalSettings")),m("label",{className:"FormLabel"},s.translator.trans("wusong8899-client1.admin.TransitionTime")),m("input",{className:"FormControl",type:"number",min:"1000",max:"30000",value:this.settings.transitionTime,oninput:t=>{this.settings.transitionTime=parseInt(t.target.value),this.saveSettings()}})),m("div",{className:"Form-group"},m("h3",null,s.translator.trans("wusong8899-client1.admin.SlidesManagement")),this.settings.slides.map(t=>this.renderSlide(t)),m("button",{className:"Button Button--primary",onclick:()=>this.addSlide()},s.translator.trans("wusong8899-client1.admin.AddSlide"))),m("div",{className:"Form-group"},m("h3",null,s.translator.trans("wusong8899-client1.admin.SocialMediaTitle")),r.map(t=>this.renderSocialPlatform(t))))}renderSlide(t){return m("div",{className:"SlideConfig",key:t.id},m("div",{className:"SlideConfig-header"},m("h4",null,"Slide ",t.order),m("input",{type:"checkbox",checked:t.active,onchange:i=>{this.updateSlide(t.id,"active",i.target.checked)}}),m("button",{className:"Button Button--danger",onclick:()=>this.deleteSlide(t.id)},s.translator.trans("wusong8899-client1.admin.DeleteButton"))),m("div",{className:"Form-group"},m("label",{className:"FormLabel"},s.translator.trans("wusong8899-client1.admin.SlideImageLabel")),m("input",{className:"FormControl",type:"url",value:t.image,oninput:i=>{this.updateSlide(t.id,"image",i.target.value)}})),m("div",{className:"Form-group"},m("label",{className:"FormLabel"},s.translator.trans("wusong8899-client1.admin.SlideLinkLabel")),m("input",{className:"FormControl",type:"url",value:t.link,oninput:i=>{this.updateSlide(t.id,"link",i.target.value)}})))}renderSocialPlatform(t){const i=this.settings.socialLinks.find(e=>e.platform===t)||{url:"",icon:""};return m("div",{className:"SocialPlatformConfig",key:t},m("h4",null,t),m("div",{className:"Form-group"},m("label",{className:"FormLabel"},"URL"),m("input",{className:"FormControl",type:"url",placeholder:`https://${t.toLowerCase()}.com/yourprofile`,value:i.url,oninput:e=>{this.updateSocialLink(t,"url",e.target.value)}})),m("div",{className:"Form-group"},m("label",{className:"FormLabel"},"Icon URL"),m("input",{className:"FormControl",type:"url",placeholder:"https://example.com/icon.png",value:i.icon,oninput:e=>{this.updateSocialLink(t,"icon",e.target.value)}}),i.icon&&m("div",{className:"IconPreview"},m("img",{src:i.icon,alt:`${t} icon`,style:"max-width: 32px; max-height: 32px;"}))))}}s.initializers.add(n,()=>{const o=s.extensionData.for(n);o.registerSetting({setting:`${n}.settings`,type:"text",label:"",hidden:!0}),o.registerSetting({setting:`${n}.TransitionTime`,type:"number",label:"",hidden:!0}),o.registerSetting(()=>m(c))})})(flarum.core.compat["admin/app"],flarum.core.compat["common/Component"]);
//# sourceMappingURL=admin.js.map

module.exports={};